[171514, 162041, 140473, 137814, 162189, 154883, 133793, 174512, 127178, 161604, 136906, 171913, 161144, 162652, 172694, 162562, 130791, 127219, 171009, 137680,172641,152408,130282,162699,134848,174822,159964,137931,126930,144985,170023,146742,126085,164054,165215,168342,169943,166236,175597,150119,166697,175234,164622,137927,170248,170117,129291,140497,131084,140538,145792,173028,161070,134045,173089,175388,162738,162059,152867,131912,161839,174986,127268,158028,151871,171843,168652,166780,137838,169253,154866,94605,161737,175605,141169,127128,143010,141874,172307,158853,135342,163386,140243,149535,134311,154187,125960,137634,130968,148428,151982,176139,145094,164796,136939,138495,145947,176098,150388,173088,162953,166638,171229,144303,175923,175833,128813,165781,168646,127125,169993,137315,138379,162458,175282,130283,151378,171416,137655,157893,135356,152325,131726,138220,150414,133750,135499,161747,140475,162745,174987,163977,175954,127215,173822,152662,163012,126174,174342,140528,163426,127240,153708,155648,174991,162670,126721,140721,127297,166227,136941,148553,135171,156197,126798,174632,134430,138372,157280,148066,164003,161945,174108,161927,137670,143642,175514,146718,128534,172031,136805,152948,137780,161150,134618,138143,152716,134693,166770,164887,140297,137880,139919,158380,156664,129486,137753,161171,134044,162826,152368,129793,173083,144147,128620,162617,129225,161448,136729,169419,161942,164981,162805,140041,159529,113279,163195,140583,151330,138199,167369,159201,165539,155407,162972,135225,136936,156272,141971,161143,157727,129147,158685,154639,151202,149838,151878,174445,152173,147070,162554,153182,158815,145132,172866,150255,140844,151443,155946,164751,168385,161498,164464,142841,156349,162984,159162,175897,151192,171036,137313,175946,131548,165212,163939,162889,161794,139540,164695,149808,165778,174637,141179,162993,140760,144643,169032,128702,161472,140679,169522,171960,158775,160730,162757,127380,138617,146770,150500,171911,127310,152453,130466,127841,172218,164929,174406,161743,169518,137202,146757,175377,136614,164679,127073,136816,168721,128432,171909,131085,175269,128244,168584,163040,129229,138140,162573,126703,168216,138886,176057,166598,162713,164192,163918,168720,139095,130404,141208,144771,128238,135398,171995,160719,144316,156037,128526,161060,165012,129578,136768,174588,150987,147492,163532,134035,172905,163554,143281,137614,137627,129287,138884,172494,140406,172744,136277,155501,165682,162546,137526,143568,134515,145915,174838,166811,127480,141015,161137,170822,139130,172384,151825,173225,128495,163874,166268,134420,166004,167554,149087,149861,175595,146378,134663,138462,172010,127082,127391,138616,150517,169364,171073,127173,169622,174888,155975,151137,131878,162643,161351,164853,128450,165912,155792,174144,128639,165030,167495,166756,137366,143604,157582,166307,144164,161890,171636,150206,132482,161109,126124,140305,173026,128626,138610,129009,161436,128536,132677,133303,164311,141216,164068,164473,137581,127462,149113,162576,163666,171707,172584,129411,172392,175245,175730,88674,130588,156873,137607,167012,126705,155410,171929,127044,127238,164385,148206,171429,128436,162150,134201,174489,158217,165852,128433,160516,168118,128273,171972,151452,151867,135522,136697,139164,160777,139982,128726,136658,140775,135884,136549,149165,162575,144415,176115,139909,145602,152546,161119,175924,128389,129623,137175,127054,134954,152021,154626,168117,170856,154843,161063,162906,142889,170852,134959,163540,128181,138980,141658,149595,157912,159882,131173,134874,168128,159206,132291,126176,136849,145797,162904,134061,165477,130210,155135,131072,149037,162637,166531,89909,163068,163260,134741,161086,162488,164371,128900,134570,139963,149274,163546,132424,139984,149728,163629,171375,146560,147233,175992,129806,152005,168928,161736,162377,127694,128505,166094,168433,169379,128810,132228,147208,152169,158212,166080,169616,126775,132598,169299,147792,169680,176056,141703,159313,169138,173996,130881,161477,127033,128857,146609,173024,175210,131690,140720,142218,156719,126453,128442,134606,174574,175588,136647,127313,132640,143823,134713,163611,153269,163754,127795,134041,149543,153355,164532,153993,127837,140029,142228,144824,149699,149107,150242,127692,153460,161170,173285,131032,131689,132457,157030,164383,165988,171020,151826,162851,173269,157292,161471,165048,166039,167538,161774,175337,128579,141101,161460,167469,132592,135395,137535,142718,163533,128395,142684,163746,168112,127144,165216,167362,173165,175853,133812,136766,148801,155059,128507,141091,159791,137181,139272,151185,170408,136772,138910,160947,165642,136811,127037,131619,165122,166420,132399,136191,142415,163390,128934,138656,139855,140144,155406,126699,152575,152747,161787,162607,170156,170853,139324,150125,157174,164067,168389,170854,127030,129933,163770,128758,131691,132589,155360,165476,139866,140312,151799,163303,128797,131696,161061,161637,169409,169629,155392,163244,137542,162541,162771,164462,166318,127727,128613,129499,162358,165779,167357,157217,161817,161965,134930,136862,138768,156171,165207,162881,167364,128669,134744,134882,138089,140007,148572,164777,135802,144133,150850,161508,117426,131059,134422,135205,136330,138618,139294,141661,167281,168978,128719,153810,127338,140631,151247,172580,129752,141665,146657,148871,156867,174673,147219,153373,162211,163091,143022,164790,136419,158766,161845,163569,165079,127405,134554,140829,135386,140366,164661,131948,143633,150121,164248,167197,167263,168119,127034,138883,128941,132108,137271,173519,128849,139939,132407,136924,137404,137615,161748,162647,165509,174597,127023,165705,170923,127722,139154,153421,162542,163687,127148,129740,131625,131813,136814,136979,150036,163634,127167,128390,131049,172785,128232,134764,140783,151199,164536,164948,172950,174394,136719,163184,172293,175913,126813,128207,140425,145328,162160,162823,166032,135320,137624,141441,150320,156576,165698,172367,129842,131965,132660,133980,164841,164862,166495,173826,134753,138022,159053,160474,171367,127293,136645,137737,138079,139260,152093,131047,156119,158686,159044,161603,162072,174134,134732,138614,151934,154029,155069,163201,166322,134726,136726,129934,157819,164580,165341,126698,127351,135390,136763,138606,149788,155950,175372,175787,126148,127027,127897,135108,136888,141090,147364,173731,174009,128935,134894,136837,142862,151176,168598,171848,129515,134307,136684,144433,163080,166998,134439,138236,153410,154800,162737,171760,132323,136644,137323,140897,140918,146297,151418,160720,160946,131478,137045,143907,144897,151188,151875,153121,170965,172023,173287,127534,127731,134435,139544,155107,157037,162294,165756,170044,171343,175850,131025,135724,136141,136870,140279,158707,163401,171168,173820,129848,132620,134564,137340,137696,137755,146613,164256,175261,127287,131855,138148,139696,144302,149676,163255,164198,164436,170850,137140,139331,140368,145767,147537,156235,163522,164388,165218,166377,167411,174940,131649,134427,136774,137048,139832,139834,163153,164533,171035,174287,175982,98156,139065,139263,140171,169061,172982,173084,128106,135307,140139,154893,167061,168736,172812,136319,137227,140399,150132,152426,162545,162585,170675,129797,132156,142843,155914,162347,168399,126179,132456,137468,137837,140604,142604,151413,153330,154844,158242,161602,164802,171071,176163,126781,127209,129657,131056,134048,139339,142950,150847,151874,159317,161076,162190,166229,169418,126229,127181,129547,134767,136802,139045,149128,159826,162182,165009,128671,134447,134885,140344,140369,150240,163941,166321,166378,171335,172394,134039,134247,136944,140849,141378,143901,150229,151051,161742,163883,164365,165758,165821,171773,173853,174542,129538,135681,136781,138018,169897,170701,136160,136678,141064,141523,141672,142394,147738,149549,150076,150283,152480,152944,157351,161701,163314,163886,164527,170006,134249,136481,137316,139767,140005,141439,141818,142719,150419,151977,158403,159800,161560,163994,172314,172633,128045,134520,136457,137525,139410,141468,144828,150244,163548,167580,172901,117330,126257,126594,136983,137571,137616,138332,144277,158637,163198,163747,164949,170526,174180,174229,175216,139901,142378,143572,143650,147336,152711,153729,165692,127347,136254,137210,137772,139337,145557,160489,165503,168409,171320,171783,171919,127153,128502,134761,136776,139032,139921,151985,154009,156298,159344,162537,162890,164490,165766,166232,166305,168255,174003,175381,131919,136679,136789,137270,146143,147241,150365,150885,150911,163187,163335,163670,163756,164619,165090,166317,171910,173852,127476,127671,135196,136628,136973,146963,150456,157399,158592,159204,161659,162529,163387,164479,164691,164836,164842,166231,168042,170958,171137,127069,137205,140006,142704,153791,156679,162814,164534,165049,170033,172344,174219,176134,127363,129293,134461,136646,139255,152791,153726,156803,161085,161452,161777,163863,164923,164993,165324,169987,127389,129137,133925,134036,136724,137604,138868,152644,154763,161062,163615,163797,165001,166601,172879,173172,173282,96011,128366,131673,136767,137849,138776,145265,152028,152856,157769,158113,162056,166076,168039,169139,169183,170214,171745,131668,137421,137673,138098,139250,140022,140628,141100,145601,148578,161066,162644,162915,164483,166781,168359,172647,127035,135054,137731,138718,143525,143608,144262,150877,160023,160954,162322,164093,165412,167841,169985,170855,171064,171736,172210,172969,127425,132284,134291,136156,138571,139490,139896,143573,150008,152024,152765,153541,153661,154699,155269,160606,161856,163807,164167,166261,167582,168724,172217,176021,176086,128807,131942,134627,140325,140381,142423,143202,147226,148662,149821,150992,152735,154789,157551,157794,158079,161120,162922,163097,163252,165458,168982,170196,172587,173081,174887,174919,175280,125104,127447,128476,129170,129731,132442,133813,133820,134442,134759,136859,137431,139021,140644,142782,144181,147837,151943,158070,159291,161580,162590,163789,165024,166679,168396,170259,171110,174139,126125,129729,129856,130190,132439,136654,136686,138461,138973,139608,141649,144232,150252,152287,156399,161911,162539,164744,165378,166300,167176,168901,171147,171851,172281,172741,172756,174247,175725,126313,127053,127845,127865,129051,131825,134939,135314,140719,142072,145509,148787,151381,154909,160286,161826,162380,163663,164345,164576,165007,165092,166320,167430,167854,168164,169020,170616,173683,173755,127031,127049,129331,131044,136548,136730,136938,137212,137785,137990,140241,140402,140634,143511,144144,146759,147485,147557,148333,148334,150528,150802,151383,161045,161680,162758,163166,163334,164114,165843,166993,169887,170111,172134,172302,174068,123743,127052,131544,132418,133879,133976,134230,134827,137044,137234,138013,139429,140253,140385,144270,148802,149225,151882,152255,152342,156020,157208,157589,158080,161198,161752,161981,162206,162224,162605,163190,163427,164296,165375,170878,171687,171858,172150,174105,126696,127990,131522,135473,137131,137183,137540,138911,139106,140304,140639,142892,143241,148654,150513,156154,156177,156433,156935,159748,161491,162075,162691,163948,164249,164266,165414,165620,168650,170374,171190,171365,171552,172421,173784,174088,174540,126347,127815,127903,128446,131720,134817,136725,136740,136839,137485,137533,138348,138441,139553,140958,145126,145781,146543,147200,150224,152750,152875,154157,156168,156888,159680,162213,163578,163618,164018,164083,165003,167029,167987,170204,170372,172748,173652,126423,127065,127190,127271,127852,130939,131981,133938,134097,135173,135543,136785,137277,137383,137524,137870,139207,140376,140487,140624,141007,141088,141894,142358,142546,144227,144566,148517,149228,149809,150290,152561,152946,155973,161597,161966,162071,163354,164347,164947,165005,165426,165984,166065,166772,167001,167355,168044,171688,171820,171976,172511,174413,126132,126793,127270,130753,131024,132390,132646,132759,134114,134638,135593,135889,136693,136834,137187,138496,139694,140267,141885,141958,144663,146103,146629,149783,149925,150801,150813,151642,153707,153789,156844,157849,157922,158871,161731,161791,162702,163328,163640,163711,164332,166051,166099,166841,168882,169434,169618,170136,171516,171593,171619,172464,172795,173818,174778,127026,127092,127303,127660,128239,132440,133797,133866,134647,134871,136885,137294,137397,137648,138142,138513,138698,139072,139173,139192,140588,140828,141116,141663,142901,143262,144837,145355,146153,146747,146748,148501,150006,151132,151190,152842,157843,159942,161923,162364,162631,162634,162678,162807,162903,163412,163685,163846,163989,165405,166205,166359,166707,167356,167381,168124,169264,169733,170063,170381,170543,171718,173095,173713,173808,174174,174915,175799,127072,127410,128131,129295,131636,131662,134047,136708,136867,137281,137447,137654,139571,139768,139839,139969,140062,140338,140395,140495,140513,140565,140651,140878,141206,141409,141486,142335,142637,143179,144705,144936,145121,145559,146445,147879,148533,149394,151166,152068,152216,152484,152557,153226,153618,154779,156900,157374,158016,158740,158924,159263,159651,160536,162233,163836,164670,165342,165800,166546,168391,168977,170056,170539,172011,172978,173195,175160,175235,175287,126493,127256,127337,127745,127943,129161,129465,130531,130800,130913,131882,132097,132362,132569,132642,134250,134495,134671,134756,135198,135591,135787,136710,136738,136815,137033,137204,137355,137432,137547,137806,137894,138865,138985,139658,139928,139951,140086,140211,140278,140316,140417,140564,140597,140622,141376,142502,142773,142929,143792,144834,145575,145655,145761,146007,147259,148420,148577,149250,149804,149839,152214,152259,152328,152491,153015,153148,153258,153434,154777,154891,155800,156279,157448,157661,158046,158112,158715,159257,161455,162172,162613,163919,164155,164187,164285,164465,164472,165080,165782,166760,167860,168645,168722,169025,169047,169615,169912,171228,171517,171914,172085,172468,172515,173114,173235,173280,174090,174439,174510,174533,174870,175767,126788,127096,127214,127332,127599,127792,128177,128235,128647,128809,128970,130688,131637,131858,132409,132596,132647,133459,134441,134516,134762,134955,135093,135123,135414,135564,135612,136421,136648,136750,137331,137651,137674,137710,138576,138806,138869,139109,139127,139257,139264,139320,139491,139636,139840,139918,140100,140173,140212,140294,140975,140988,141219,141270,141520,141521,142066,142954,143228,143697,144146,144781,144863,145205,145455,146002,146207,146793,148163,148780,148901,149333,149889,149982,150052,150507,150523,150799,151130,151434,151649,152174,152212,152339,152728,153881,154495,156030,156221,157051,157660,158014,159512,160186,160388,160458,160702,161586,161590,161938,162006,162552,162557,163513,163795,164118,164284,164428,164595,164689,164951,165095,165502,165670,165851,166044,167165,167195,167504,167583,170167,170379,170677,171470,171646,172086,172146,172168,172461,172649,172719,172809,172895,174112,174209,174867,174901,174914,175026,175129].each do |user_id|
  user = User.find(user_id)
  next unless user
  listing_ids = user.listings.managed.selected.not_published.warnings_or_without_problems.first(200000).pluck(:id)
  if listing_ids.empty?
    Utils::PushSlack.push_japan_publish("user_id:#{user_id},没有待发布商品，无需推送")
    next
  end
  Utils::PushSlack.push_japan_publish("user_id:#{user_id},需要推送#{listing_ids.size}个商品")

  listing_ids.each do |listing_id|
    Publishing::JapanPublishWorker.perform_async(user_id, listing_id)
  end
  Utils::PushSlack.push_japan_publish("user_id:#{user_id},推送#{user_id}完成")
end